(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1057:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>L});var t=r(5155),a=r(2115),l=r(1201),c=r(2708),n=r(3162),i=r(9031),d=r(9167),o=r(5998),x=r(3580),m=r(3071),h=r(306),u=r(9856),g=r(5802),j=r(4520),p=r(1493),b=r(3588),N=r(5895),y=r(5476),f=r(5628),v=r(2612),k=r(3966),w=r(8397),S=r(1874),A=r(3119),z=r(7124),C=r(1131),I=r(4881),O=r(2596),E=r(9688);function W(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,E.QP)((0,O.$)(s))}let T="wss://bot.meml.xyz/sign/list",R=()=>{let[e,s]=(0,a.useState)(()=>localStorage.getItem("theme")||"light"),r=(0,a.useCallback)(()=>{let r="light"===e?"dark":"light";s(r),localStorage.setItem("theme",r),document.documentElement.classList.toggle("dark","dark"===r)},[e]);return(0,a.useEffect)(()=>{document.documentElement.classList.toggle("dark","dark"===e)},[e]),{theme:e,toggleTheme:r}},P=e=>{let{icon:s,label:r,value:a,color:n="primary",description:i}=e;return(0,t.jsx)(l.Z,{className:"bg-gradient-to-br from-white/60 to-white/30 dark:from-gray-800/60 dark:to-gray-800/30 backdrop-blur-xl border-white/20 dark:border-gray-700/30 hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-2xl",children:(0,t.jsx)(c.U,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:W("p-3 rounded-2xl","primary"===n&&"bg-blue-500/20 text-blue-600 dark:text-blue-400","secondary"===n&&"bg-purple-500/20 text-purple-600 dark:text-purple-400","success"===n&&"bg-green-500/20 text-green-600 dark:text-green-400","warning"===n&&"bg-orange-500/20 text-orange-600 dark:text-orange-400"),children:(0,t.jsx)(s,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200",children:a}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 font-medium",children:r}),i&&(0,t.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:i})]})]})})})},_=e=>{let{isConnected:s,connectionAttempts:r,error:a}=e,{isOpen:l,onOpen:c,onClose:n}=(0,h.j)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.I,{content:a?"错误: ".concat(a):s?"连接正常":"重连中... (".concat(r,"/").concat(5,")"),color:a?"danger":s?"success":"warning",children:(0,t.jsx)(x.T,{isIconOnly:!0,variant:"flat",size:"sm",color:a?"danger":s?"success":"warning",className:"min-w-unit-10 h-unit-10",onPress:c,children:a?(0,t.jsx)(f.A,{className:"w-4 h-4"}):s?(0,t.jsx)(v.A,{className:"w-4 h-4"}):(0,t.jsx)(m.o,{size:"sm"})})}),(0,t.jsx)(u.Y,{isOpen:l,onClose:n,size:"md",children:(0,t.jsxs)(g.g,{children:[(0,t.jsx)(j.c,{className:"flex flex-col gap-1",children:"连接状态详情"}),(0,t.jsx)(p.h,{className:"pb-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"连接状态"}),(0,t.jsx)(d.R,{color:a?"danger":s?"success":"warning",variant:"flat",size:"sm",children:a?"连接失败":s?"已连接":"连接中"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"服务器地址"}),(0,t.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded",children:T})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"重连次数"}),(0,t.jsxs)("span",{className:"text-sm",children:[r,"/",5]})]}),r>0&&r<5&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"重连进度"}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(r/5*100),"%"]})]}),(0,t.jsx)(y.o,{value:r/5*100,color:"warning",size:"sm",className:"w-full"})]}),a&&(0,t.jsxs)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[(0,t.jsx)("p",{className:"text-sm text-red-700 dark:text-red-300 font-medium",children:"错误信息"}),(0,t.jsx)("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:a})]})]})})]})})]})},M=e=>{let{item:s,index:r}=e,[n,i]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let e=setTimeout(()=>i(!0),50*r);return()=>clearTimeout(e)},[r]);let m=(0,a.useMemo)(()=>"".concat(s.uin,"-").concat(s.version),[s.uin,s.version]);return(0,t.jsx)("div",{className:W("transform transition-all duration-500 ease-out",n?"translate-y-0 opacity-100":"translate-y-4 opacity-0"),children:(0,t.jsx)(l.Z,{className:"bg-white/70 dark:bg-gray-800/70 backdrop-blur-xl border-white/30 dark:border-gray-700/30 hover:bg-white/90 dark:hover:bg-gray-800/90 transition-all duration-300 hover:shadow-xl hover:scale-[1.02] group",children:(0,t.jsx)(c.U,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(N.w,{content:"",color:"success",shape:"circle",placement:"bottom-right",children:(0,t.jsx)(o.Q,{src:"https://api.dicebear.com/7.x/bottts/svg?seed=".concat(m),className:"w-12 h-12",isBordered:!0})}),(0,t.jsx)("div",{className:"flex-1 min-w-0",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,t.jsx)(d.R,{startContent:(0,t.jsx)(k.A,{className:"w-3 h-3"}),color:"primary",variant:"flat",size:"sm",className:"text-xs font-semibold",children:s.cmd}),(0,t.jsx)(d.R,{startContent:(0,t.jsx)(w.A,{className:"w-3 h-3"}),color:"secondary",variant:"flat",size:"sm",className:"text-xs font-semibold",children:s.version}),(0,t.jsx)(d.R,{startContent:(0,t.jsx)(S.A,{className:"w-3 h-3"}),color:"success",variant:"flat",size:"sm",className:"text-xs font-semibold",children:s.path})]})}),(0,t.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,t.jsx)(b.I,{content:"服务详情",children:(0,t.jsx)(x.T,{isIconOnly:!0,variant:"light",size:"sm",className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,t.jsx)(A.A,{className:"w-4 h-4"})})})})]})})})})},Q=e=>{let{isLoading:s,error:r,signList:a}=e;return s?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-2 border-primary rounded-full animate-spin border-t-transparent"}),(0,t.jsx)("p",{className:"mt-4 text-lg font-medium text-gray-600 dark:text-gray-400",children:"加载中..."})]}):r?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,t.jsx)("div",{className:"text-red-500 mb-4",children:(0,t.jsx)(f.A,{className:"w-12 h-12"})}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"连接失败"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-500",children:r})]}):s||0!==a.length?null:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-4",children:(0,t.jsx)(S.A,{className:"w-12 h-12"})}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-600 dark:text-gray-400",children:"暂无在线服务"})]})};function L(){let{theme:e,toggleTheme:s}=R(),[r,m]=(0,a.useState)([]),[h,u]=(0,a.useState)(!1),[g,j]=(0,a.useState)(null),[p,y]=(0,a.useState)(0),[f,v]=(0,a.useState)(!0),A=(0,a.useRef)(null),O=(0,a.useRef)(null),E=(0,a.useRef)(null),L=(0,a.useCallback)(()=>{if(A.current&&A.current.readyState===WebSocket.OPEN)return void console.log("已有 WebSocket 连接，跳过");if(A.current&&(A.current.readyState===WebSocket.OPEN||A.current.readyState===WebSocket.CONNECTING))return void console.warn("WebSocket 已存在或正在连接，跳过本次连接");let e=new WebSocket(T);A.current=e,y(e=>e+1),e.onopen=()=>{console.log("WebSocket 已连接"),E.current&&(clearTimeout(E.current),E.current=null),u(!0),j(null),v(!1),y(0),e.send(JSON.stringify({type:"list"})),O.current=setInterval(()=>{e.readyState===WebSocket.OPEN&&e.send(JSON.stringify({type:"keepalive"}))},3e4)},e.onmessage=e=>{try{let s=JSON.parse(e.data);"list"===s.type&&Array.isArray(s.data)?m(s.data):"push"===s.type&&s.data&&m(e=>[s.data,...e])}catch(e){console.error("WebSocket 消息解析错误",e)}},e.onerror=e=>{console.error("WebSocket 错误",e),j("连接错误"),u(!1),v(!1)},e.onclose=()=>{console.warn("WebSocket 已关闭"),u(!1),O.current&&clearInterval(O.current),p<5?E.current=setTimeout(()=>{L()},3e3):(j("连接失败，已达到最大重试次数"),v(!1))}},[p]);(0,a.useEffect)(()=>(L(),()=>{O.current&&clearInterval(O.current),E.current&&clearTimeout(E.current)}),[L]);let U=(0,a.useMemo)(()=>{let e=new Set(r.map(e=>e.cmd)).size,s=new Set(r.map(e=>e.version)).size,t=new Set(r.map(e=>e.path)).size;return{total:r.length,commands:e,versions:s,paths:t}},[r]);return(0,t.jsxs)("div",{className:W("min-h-screen transition-all duration-500","bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50","dark:from-gray-900 dark:via-indigo-950 dark:to-purple-950"),children:[(0,t.jsx)("div",{className:"fixed top-6 right-6 z-50",children:(0,t.jsx)(b.I,{content:"切换到".concat("light"===e?"深色":"浅色","模式"),children:(0,t.jsx)(x.T,{isIconOnly:!0,variant:"flat",className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border-white/30 dark:border-gray-700/30 hover:scale-110 transition-all duration-300 shadow-lg",onPress:s,children:"light"===e?(0,t.jsx)(z.A,{className:"w-5 h-5"}):(0,t.jsx)(C.A,{className:"w-5 h-5"})})})}),(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)(l.Z,{className:"bg-gradient-to-r from-white/60 to-white/30 dark:from-gray-800/60 dark:to-gray-800/30 backdrop-blur-xl border-white/20 dark:border-gray-700/30 shadow-2xl",children:(0,t.jsx)(n.d,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(N.w,{content:(0,t.jsx)(I.A,{className:"w-3 h-3"}),color:"success",placement:"bottom-right",children:(0,t.jsx)(o.Q,{src:"https://api.dicebear.com/7.x/bottts/svg?seed=qsign",className:"w-16 h-16",isBordered:!0})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 dark:from-blue-400 dark:to-purple-400 bg-clip-text text-transparent",children:"QSign 服务面板"}),(0,t.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"实时监控在线服务状态"})]})]}),(0,t.jsx)(_,{isConnected:h,connectionAttempts:p,error:g})]})})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,t.jsx)(P,{icon:S.A,label:"UIN总数",value:U.commands,color:"primary",description:"当前在线的QSign服务数"}),(0,t.jsx)(P,{icon:k.A,label:"CMD总数",value:U.commands,color:"secondary",description:"不同的CMD类型数量"}),(0,t.jsx)(P,{icon:w.A,label:"版本总数",value:U.versions,color:"success",description:"不同的版本数量"}),(0,t.jsx)(P,{icon:S.A,label:"路径总数",value:U.paths,color:"warning",description:"不同的安装路径数量"}),(0,t.jsx)(P,{icon:I.A,label:"记录总数",value:U.total,color:"danger",description:"所有的记录总数"})]}),(0,t.jsxs)(l.Z,{className:"bg-white/40 dark:bg-gray-800/40 backdrop-blur-2xl border-white/30 dark:border-gray-700/30 shadow-2xl",children:[(0,t.jsx)(n.d,{className:"border-b border-white/20 dark:border-gray-700/30",children:(0,t.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 rounded-lg bg-blue-500/20",children:(0,t.jsx)(S.A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"在线服务列表"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"实时同步服务状态"})]})]}),(0,t.jsx)(d.R,{color:h?"success":"warning",variant:"flat",size:"sm",children:h?"实时更新":"连接中"})]})}),(0,t.jsx)(c.U,{className:"p-0",children:(0,t.jsxs)(i.H,{className:"h-[calc(80vh-4rem)] p-4 relative",children:[(0,t.jsx)(Q,{isLoading:f,error:g,signList:r}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4",children:r.map((e,s)=>(0,t.jsx)(M,{item:e,index:s},s))})]})})]})]})]})}},9565:(e,s,r)=>{Promise.resolve().then(r.bind(r,1057))}},e=>{var s=s=>e(e.s=s);e.O(0,[163,767,441,684,358],()=>s(9565)),_N_E=e.O()}]);